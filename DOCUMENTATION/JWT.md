# üîê JWT (JSON Web Token) - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. [–ß—Ç–æ —Ç–∞–∫–æ–µ JWT](#—á—Ç–æ-—Ç–∞–∫–æ–µ-jwt)
2. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ JWT —Ç–æ–∫–µ–Ω–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-jwt-—Ç–æ–∫–µ–Ω–∞)
3. [–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è](#–∫–∞–∫-—Ä–∞–±–æ—Ç–∞–µ—Ç-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
4. [–°—Ä–æ–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è](#—Å—Ä–æ–∫–∏-–¥–µ–π—Å—Ç–≤–∏—è)
5. [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
6. [–ü—Ä–∏–º–µ—Ä—ã](#–ø—Ä–∏–º–µ—Ä—ã)

---

## –ß—Ç–æ —Ç–∞–∫–æ–µ JWT?

**JWT (JSON Web Token)** ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º.

**–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä:**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–Ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å email test@example.com"
–°–µ—Ä–≤–µ—Ä: "–û–∫–µ–π, –≤–æ—Ç —Ç–µ–±–µ —ç—Ç–æ –≤ –≤–∏–¥–µ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞"
–¢–æ–∫–µ–Ω: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–Ø —Ö–æ—á—É —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑" + –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–æ–∫–µ–Ω
–°–µ—Ä–≤–µ—Ä: "–ü—Ä–æ–≤–µ—Ä—è—é –ø–æ–¥–ø–∏—Å—å —Ç–æ–∫–µ–Ω–∞... ‚úÖ OK, —Å–æ–∑–¥–∞—é –∑–∞–∫–∞–∑"
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ JWT —Ç–æ–∫–µ–Ω–∞

JWT —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 3 —á–∞—Å—Ç–µ–π, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç–æ—á–∫–∞–º–∏:

```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9 . eyJzdWIiOiJ0ZXN0QGV4YW1wbGUuY29tIiwiaWF0IjoxNzAz... . SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
‚îÇ                                      ‚îÇ ‚îÇ                                                    ‚îÇ ‚îÇ                                        ‚îÇ
‚îÇ HEADER (–∑–∞–≥–æ–ª–æ–≤–æ–∫)                   ‚îÇ ‚îÇ PAYLOAD (–¥–∞–Ω–Ω—ã–µ)                                   ‚îÇ ‚îÇ SIGNATURE (–ø–æ–¥–ø–∏—Å—å)                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ß–∞—Å—Ç—å 1: HEADER
```json
{
  "alg": "HS256",  // –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
  "typ": "JWT"     // —Ç–∏–ø —Ç–æ–∫–µ–Ω–∞
}
```

–ö–æ–¥–∏—Ä—É–µ—Ç—Å—è –≤ Base64: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9`

### –ß–∞—Å—Ç—å 2: PAYLOAD (—Å–∞–º–∞—è –≤–∞–∂–Ω–∞—è)
```json
{
  "sub": "test@example.com",           // —Ç–µ–º–∞ (–æ–±—ã—á–Ω–æ email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
  "iat": 1703001234,                   // issued at (–≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è)
  "exp": 1703087634,                   // expiration (–≤—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è)
  "userType": "CLIENT",                // –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  "roles": ["ROLE_USER"]
}
```

–ö–æ–¥–∏—Ä—É–µ—Ç—Å—è –≤ Base64: `eyJzdWIiOiJ0ZXN0QGV4YW1wbGUuY29tIiwiaWF0IjoxNzAz...`

### –ß–∞—Å—Ç—å 3: SIGNATURE (–ø–æ–¥–ø–∏—Å—å)
```
HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  "ba00e0f78924f99ac42be10faf5ee1fc0147de930de02cb05e2145e61e0f0a47"  // —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á
)
```

**–ó–∞—á–µ–º –ø–æ–¥–ø–∏—Å—å?** –ß—Ç–æ–±—ã –Ω–∏–∫—Ç–æ –Ω–µ –º–æ–≥ –ø–æ–¥–¥–µ–ª—å–∏—Ç—å —Ç–æ–∫–µ–Ω. –ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å —Ö–æ—Ç—å –æ–¥–Ω—É –±—É–∫–≤—É –≤ payload, –ø–æ–¥–ø–∏—Å—å –Ω–µ —Å–æ–≤–ø–∞–¥–µ—Ç!

---

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### –®–∞–≥ 1: –õ–æ–≥–∏–Ω (–ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞)

```
–ö–ª–∏–µ–Ω—Ç                          –°–µ—Ä–≤–µ—Ä
   ‚îÇ                               ‚îÇ
   ‚îÇ‚îÄ POST /auth/login ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí‚îÇ
   ‚îÇ  {email, password}             ‚îÇ
   ‚îÇ                                ‚îÇ
   ‚îÇ –ü—Ä–æ–≤–µ—Ä–∫–∞ email/–ø–∞—Ä–æ–ª—å         ‚îÇ
   ‚îÇ –ï—Å–ª–∏ OK ‚Üí –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º JWT       ‚îÇ
   ‚îÇ                                ‚îÇ
   ‚îÇ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–∫–µ–Ω ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
   ‚îÇ        "eyJhbGci..."           ‚îÇ
   ‚îÇ                                ‚îÇ
```

**–ö–æ–¥ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ:**
```javascript
const response = await api.post('/auth/login', {
    email: 'user@example.com',
    password: '123456'
});

const token = response.data;  // "eyJhbGci..."
setToken(token);  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
```

**–ö–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Java):**
```java
@PostMapping("/login")
public String authenticateUser(@RequestBody AuthRequestDto dto) {
    Authentication authentication = authenticationManager.authenticate(
        new UsernamePasswordAuthenticationToken(dto.getEmail(), dto.getPassword())
    );
    
    final UserDetails userDetails = (UserDetails) authentication.getPrincipal();
    return jwtUtils.generateToken(userDetails.getUsername());  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–∫–µ–Ω
}
```

---

### –®–∞–≥ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ (–∑–∞—â–∏—â–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã)

```
–ö–ª–∏–µ–Ω—Ç                          –°–µ—Ä–≤–µ—Ä
   ‚îÇ                               ‚îÇ
   ‚îÇ‚îÄ GET /api/profile ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí‚îÇ
   ‚îÇ  Authorization: Bearer TOKEN   ‚îÇ
   ‚îÇ                                ‚îÇ
   ‚îÇ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏               ‚îÇ
   ‚îÇ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è        ‚îÇ
   ‚îÇ –ï—Å–ª–∏ OK ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å   ‚îÇ
   ‚îÇ                                ‚îÇ
   ‚îÇ‚Üê‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ {name, email, ...} ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
   ‚îÇ                                ‚îÇ
```

**–ö–æ–¥ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ:**
```javascript
const response = await api.get('/api/profile');
// –¢–æ–∫–µ–Ω –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ interceptor!
```

**–ö–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –∑–∞–ø—Ä–æ—Å:**
```http
GET /api/profile HTTP/1.1
Host: localhost:8080
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0QGV4YW1wbGUuY29tIiwiaWF0IjoxNzAz...
Content-Type: application/json
```

**–ö–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Java):**
```java
@GetMapping("/profile")
@PreAuthorize("isAuthenticated()")
public UserInfoDto getProfile() {
    String email = SecurityContextHolder.getContext()
        .getAuthentication()
        .getName();  // "test@example.com"
    
    User user = userRepository.findByEmail(email);
    return new UserInfoDto(user);
}
```

---

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)

–ö–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–∫–µ–Ω, –æ–Ω:

```java
public boolean validateJwtToken(String token) {
    try {
        Jwts.parser()
            .verifyWith(key)      // ‚Üê –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å —Å –ø–æ–º–æ—â—å—é —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞
            .build()
            .parseSignedClaims(token);  // ‚Üê –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è
        return true;
    } catch (Exception e) {
        log.error("JWT validation error: {}", e.getMessage());
    }
    return false;
}
```

**–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á:** `ba00e0f78924f99ac42be10faf5ee1fc0147de930de02cb05e2145e61e0f0a47`

–ï—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–¥–¥–µ–ª–∞—Ç—å —Ç–æ–∫–µ–Ω, –ø–æ–¥–ø–∏—Å—å –Ω–µ —Å–æ–≤–ø–∞–¥–µ—Ç –∏ —Å–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω–µ—Ç 401.

---

### –®–∞–≥ 4: –ò—Å—Ç–µ—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

–¢–æ–∫–µ–Ω –¥–µ–π—Å—Ç–≤—É–µ—Ç 6 –º–∏–Ω—É—Ç (360000 –º—Å):

```
–í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è: 10:00:00
–í—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è: 10:06:00
                   ‚Üì
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ 10:06:30 –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å
–°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–∫–µ–Ω ‚Üí exp = 10:06:00, —Å–µ–π—á–∞—Å 10:06:30
‚ùå –¢–æ–∫–µ–Ω –∏—Å—Ç–µ–∫! ‚Üí 401 Unauthorized
```

**–ù–∞ –∫–ª–∏–µ–Ω—Ç–µ:**
```javascript
// Response Interceptor –ª–æ–≤–∏—Ç 401
if (status === 401) {
    removeToken();  // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω
    window.location.href = '/login';  // –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –ª–æ–≥–∏–Ω
}
```

---

## –°—Ä–æ–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è

–í `application.properties`:
```properties
jwt.expiration=360000  # 6 –º–∏–Ω—É—Ç –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
```

**–û–±—ã—á–Ω—ã–µ —Å—Ä–æ–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π:**

| –¢–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | –°—Ä–æ–∫ | –ü—Ä–∏—á–∏–Ω–∞ |
|---|---|---|
| –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ | 7 –¥–Ω–µ–π | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–¥–∫–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç |
| –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ | 1-24 —á–∞—Å–∞ | –ë—Ä–∞—É–∑–µ—Ä —á–∞—Å—Ç–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è/–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è |
| API —Å–µ—Ä–≤–∏—Å | 15 –º–∏–Ω—É—Ç | –í—ã—Å–æ–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ |
| –¢–µ–∫—É—â–∏–π –ø—Ä–æ–µ–∫—Ç | 6 –º–∏–Ω—É—Ç | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞/—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |

**–ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å:**
```properties
jwt.expiration=86400000  # 1 –¥–µ–Ω—å (24 —á–∞—Å–∞)
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ

1. **–¢–æ–∫–µ–Ω –≤ localStorage**
```javascript
localStorage.setItem('token', token);
```
‚úÖ OK –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, —Ç–∞–∫ –∫–∞–∫ —Ç–æ–ª—å–∫–æ JS –º–æ–∂–µ—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å

2. **–û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Authorization –∑–∞–≥–æ–ª–æ–≤–∫–µ**
```
Authorization: Bearer eyJhbGci...
```
‚úÖ OK, –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø–æ HTTPS

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**
```java
Jwts.parser().verifyWith(key).build().parseSignedClaims(token);
```
‚úÖ OK, –Ω–∏–∫—Ç–æ –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–¥–µ–ª–∞—Ç—å —Ç–æ–∫–µ–Ω –±–µ–∑ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞

---

### ‚ö†Ô∏è –û–ø–∞—Å–Ω–æ

1. **–•—Ä–∞–Ω–µ–Ω–∏–µ –≤ cookie –±–µ–∑ HttpOnly —Ñ–ª–∞–≥–∞**
```javascript
// ‚ùå –ü–ª–æ—Ö–æ: XSS –∞—Ç–∞–∫–∞ –º–æ–∂–µ—Ç —É–∫—Ä–∞—Å—Ç—å —Ç–æ–∫–µ–Ω
document.cookie = "token=" + token;
```

2. **–ü–µ—Ä–µ–¥–∞—á–∞ —Ç–æ–∫–µ–Ω–∞ –≤ URL**
```javascript
// ‚ùå –ü–ª–æ—Ö–æ: —Ç–æ–∫–µ–Ω –≤ –ª–æ–≥–∞—Ö
GET /api/profile?token=eyJhbGci...
```

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ª–∞–±–æ–≥–æ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞**
```properties
# ‚ùå –ü–ª–æ—Ö–æ
jwt.secret=123456

# ‚úÖ –•–æ—Ä–æ—à–æ (—Ç–µ–∫—É—â–∏–π –ø—Ä–æ–µ–∫—Ç)
jwt.secret=ba00e0f78924f99ac42be10faf5ee1fc0147de930de02cb05e2145e61e0f0a47
```

---

## –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –ª–æ–≥–∏–Ω–∞

```javascript
// Login.jsx
import api, { setToken } from '../api';
import { useNavigate } from 'react-router-dom';

function Login() {
    const navigate = useNavigate();
    
    async function handleLogin(email, password) {
        try {
            // 1. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º email + –ø–∞—Ä–æ–ª—å
            const response = await api.post('/auth/login', {
                email,
                password
            });
            
            // 2. –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω
            const token = response.data;  // "eyJhbGci..."
            
            // 3. –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            setToken(token);
            
            // 4. –†–µ–¥–∏—Ä–µ–∫—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            navigate('/dashboard');
            
        } catch (error) {
            alert('–û—à–∏–±–∫–∞: ' + error.message);
        }
    }
    
    return (
        <form onSubmit={(e) => {
            e.preventDefault();
            handleLogin(email, password);
        }}>
            <input type="email" />
            <input type="password" />
            <button>–í–æ–π—Ç–∏</button>
        </form>
    );
}
```

---

### –ü—Ä–∏–º–µ—Ä 2: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

```javascript
// Order.jsx
import api from '../api';

function CreateOrder() {
    async function handleCreateOrder() {
        try {
            // Request Interceptor –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–∏—Ç:
            // Authorization: Bearer eyJhbGci...
            
            const response = await api.post('/api/orders', {
                recipientName: 'John Doe',
                address: 'Almaty, st. 123'
            });
            
            console.log('–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω:', response.data);
            // {orderId: 123, status: "CREATED"}
            
        } catch (error) {
            // –ï—Å–ª–∏ 401 ‚Üí automaticallyRedirect to /login
            alert('–û—à–∏–±–∫–∞: ' + error.message);
        }
    }
    
    return <button onClick={handleCreateOrder}>–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑</button>;
}
```

---

### –ü—Ä–∏–º–µ—Ä 3: –û—Ç–ª–∞–¥–∫–∞ —Ç–æ–∫–µ–Ω–∞

```javascript
// –û—Ç–∫—Ä—ã—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:

// –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â–∏–π —Ç–æ–∫–µ–Ω
const token = localStorage.getItem('token');
console.log(token);  // "eyJhbGci..."

// –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å payload (–¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞)
// –ò—Å–ø–æ–ª—å–∑—É–π https://jwt.io (–Ω–æ –¢–û–õ–¨–ö–û –Ω–∞ dev, –Ω–µ –≤–≤–æ–¥–∏ —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω!)

// –£–¥–∞–ª–∏—Ç—å —Ç–æ–∫–µ–Ω (–¥–ª—è –≤—ã—Ö–æ–¥–∞)
localStorage.removeItem('token');

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
window.api.pingBackend()
```

---

## –†–µ–∑—é–º–µ

| –ö–æ–Ω—Ü–µ–ø—Ü–∏—è | –û–±—ä—è—Å–Ω–µ–Ω–∏–µ |
|-----------|-----------|
| **JWT** | –ü–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| **Header** | –°–æ–¥–µ—Ä–∂–∏—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è (HS256) |
| **Payload** | –°–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ (email, roles, —Å—Ä–æ–∫–∏) |
| **Signature** | –ü–æ–¥–ø–∏—Å—å, —á—Ç–æ–±—ã —Ç–æ–∫–µ–Ω –Ω–µ–ª—å–∑—è –±—ã–ª–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å |
| **localStorage** | –ì–¥–µ –º—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω –≤ –±—Ä–∞—É–∑–µ—Ä–µ |
| **Authorization –∑–∞–≥–æ–ª–æ–≤–æ–∫** | –ö–∞–∫ –º—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω —Å–µ—Ä–≤–µ—Ä—É |
| **Interceptor** | –ö–∞–∫ –º—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω |
| **401 –æ—à–∏–±–∫–∞** | –ö–æ–≥–¥–∞ —Ç–æ–∫–µ–Ω –∏—Å—Ç–µ–∫ –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω—ã–π |
| **Expiration** | –¢–æ–∫–µ–Ω –¥–µ–π—Å—Ç–≤—É–µ—Ç 6 –º–∏–Ω—É—Ç, –ø–æ—Ç–æ–º –∏—Å—Ç–µ–∫–∞–µ—Ç |
| **Redirect to /login** | –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω—É–∂–Ω–æ –∑–∞–Ω–æ–≤–æ –ª–æ–≥–∏–Ω–∏—Ç—å—Å—è |

**–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è:**
1. **–õ–æ–≥–∏–Ω** ‚Üí –ø–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω
2. **–°–æ—Ö—Ä–∞–Ω—è–µ–º** ‚Üí –≤ localStorage
3. **–ò—Å–ø–æ–ª—å–∑—É–µ–º** ‚Üí –¥–æ–±–∞–≤–ª—è–µ–º –∫ –∑–∞–ø—Ä–æ—Å–∞–º
4. **–ü—Ä–æ–≤–µ—Ä—è–µ–º** ‚Üí —Å–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å
5. **–ò—Å—Ç–µ–∫–∞–µ—Ç** ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–Ω–æ–≤–æ –ª–æ–≥–∏–Ω–∏—Ç—Å—è

---

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- https://jwt.io ‚Äî –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è JWT (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏!)
- Spring Security –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://spring.io/projects/spring-security
- Axios Interceptors: https://axios-http.com/docs/interceptors

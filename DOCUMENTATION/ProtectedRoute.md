# üõ°Ô∏è ProtectedRoute ‚Äî –ó–∞—â–∏—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –æ—Ç –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö

## –ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ?

ProtectedRoute ‚Äî —ç—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –¥–∞–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –µ—Å–ª–∏ —Ç—ã –Ω–µ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω.

**–ü—Ä–æ—Å—Ç–æ:**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç /order
    ‚Üì
ProtectedRoute –ø—Ä–æ–≤–µ—Ä—è–µ—Ç: –µ—Å—Ç—å –ª–∏ —Ç–æ–∫–µ–Ω –≤ localStorage?
    ‚Üì
–ù–µ—Ç —Ç–æ–∫–µ–Ω–∞? ‚Üí –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /login (–Ω–µ –≤–∏–¥–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É)
–ï—Å—Ç—å —Ç–æ–∫–µ–Ω? ‚Üí –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É (–≤—Å–µ –Ω–æ—Ä–º)
```

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

### 1Ô∏è‚É£ –°–æ–∑–¥–∞–µ—à—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ProtectedRoute

–§–∞–π–ª: `DoDel/src/Components/ProtectedRoute.jsx`

```javascript
import { Navigate } from 'react-router-dom';
import { getToken } from '../api';

export default function ProtectedRoute({ children }) {
    const token = getToken();
    
    // –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω–∞ –Ω–µ—Ç ‚Üí –∫–∏–¥–∞–µ–º –Ω–∞ –ª–æ–≥–∏–Ω
    if (!token) {
        return <Navigate to="/login" replace />;
    }
    
    // –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –µ—Å—Ç—å ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ, —á—Ç–æ –≤–Ω—É—Ç—Ä–∏
    return children;
}
```

**–ß—Ç–æ –∑–¥–µ—Å—å?**
- `getToken()` ‚Äî –¥–æ—Å—Ç–∞–µ—Ç —Ç–æ–∫–µ–Ω –∏–∑ localStorage
- `<Navigate to="/login" />` ‚Äî –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ –ª–æ–≥–∏–Ω –µ—Å–ª–∏ –Ω–µ—Ç —Ç–æ–∫–µ–Ω–∞
- `children` ‚Äî —ç—Ç–æ —Ç–æ, —á—Ç–æ —Ç—ã –æ–±–µ—Ä–Ω—É–ª –≤ ProtectedRoute (—Ç–≤–æ—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞)

---

### 2Ô∏è‚É£ –ò—Å–ø–æ–ª—å–∑—É–µ—à—å –≤ App.jsx

```javascript
import ProtectedRoute from './Components/ProtectedRoute';

function App() {
    return (
        <Routes>
            {/* –û–±—ã—á–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã (–¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º) */}
            <Route path="/" element={<Home />} />
            <Route path="/login" element={<Login />} />
            <Route path="/registration" element={<Registration />} />

            {/* ‚úÖ –ó–∞—â–∏—â–µ–Ω–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö) */}
            <Route 
                path='/order' 
                element={
                    <ProtectedRoute>
                        <Order />
                    </ProtectedRoute>
                } 
            />
        </Routes>
    );
}
```

**–ö–∞–∫ —á–∏—Ç–∞—Ç—å:**
- –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `/order`
- –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç `<ProtectedRoute>`
- –ï—Å–ª–∏ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω ‚Üí –≤–∏–¥–∏—Ç `<Order />`
- –ï—Å–ª–∏ –Ω–µ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/login`

---

## –ü—Ä–∏–º–µ—Ä—ã

### –ó–∞—â–∏—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–∞–Ω–∏—Ü

```javascript
<Routes>
    {/* –ü—É–±–ª–∏—á–Ω—ã–µ */}
    <Route path="/" element={<Home />} />
    <Route path="/login" element={<Login />} />
    <Route path="/registration" element={<Registration />} />

    {/* –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ */}
    <Route 
        path='/order' 
        element={
            <ProtectedRoute>
                <Order />
            </ProtectedRoute>
        } 
    />
    
    <Route 
        path='/profile' 
        element={
            <ProtectedRoute>
                <Profile />
            </ProtectedRoute>
        } 
    />
    
    <Route 
        path='/dashboard' 
        element={
            <ProtectedRoute>
                <Dashboard />
            </ProtectedRoute>
        } 
    />
</Routes>
```

### –ó–∞—â–∏—Ç–∏—Ç—å —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ä–æ–ª–∏ (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç)

–ï—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞, –Ω–æ –∏ —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```javascript
export default function ProtectedRoute({ children, requiredRole }) {
    const token = getToken();
    
    if (!token) {
        return <Navigate to="/login" replace />;
    }
    
    // TODO: –†–∞—Å—à–∏—Ä–∏—Ç—å ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–æ–ª–∏ –∏–∑ payload —Ç–æ–∫–µ–Ω–∞
    // if (requiredRole && userRole !== requiredRole) {
    //     return <Navigate to="/" replace />;
    // }
    
    return children;
}
```

–ü–æ—Ç–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
```javascript
<Route 
    path='/admin' 
    element={
        <ProtectedRoute requiredRole="ADMIN">
            <AdminPanel />
        </ProtectedRoute>
    } 
/>
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∑–∞—â–∏—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–û—Ç–∫—Ä—ã—Ç—å DevTools** (F12)
2. **–ö–æ–Ω—Å–æ–ª—å:**
   ```javascript
   // –°–º–æ—Ç—Ä–∏–º –µ—Å—Ç—å –ª–∏ —Ç–æ–∫–µ–Ω
   localStorage.getItem('token')
   // –ï—Å–ª–∏ null ‚Üí –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
   // –ï—Å–ª–∏ "eyJhbGci..." ‚Üí –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
   ```

3. **–¢–µ—Å—Ç 1: –û—Ç–∫—Ä—ã—Ç—å /order –±–µ–∑ —Ç–æ–∫–µ–Ω–∞**
   - –î–æ–∂–µ–Ω —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /login ‚úÖ

4. **–¢–µ—Å—Ç 2: –ó–∞–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è ‚Üí –æ—Ç–∫—Ä—ã—Ç—å /order**
   - –î–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É ‚úÖ

5. **–¢–µ—Å—Ç 3: –£–¥–∞–ª–∏—Ç—å —Ç–æ–∫–µ–Ω –≤ –∫–æ–Ω—Å–æ–ª–∏**
   ```javascript
   localStorage.removeItem('token');
   ```
   - –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
   - –î–æ–ª–∂–µ–Ω —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /login ‚úÖ

---

## –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

**Q: –ß—Ç–æ –µ—Å–ª–∏ —á–µ–ª–æ–≤–µ–∫ –≤—Ä—É—á–Ω—É—é –∑–∞–º–µ–Ω–∏—Ç —Ç–æ–∫–µ–Ω?**
A: –ù–µ –ø–æ–º–æ–∂–µ—Ç! –ö–æ–≥–¥–∞ –æ–Ω –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å, —Å–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å —Ç–æ–∫–µ–Ω–∞. –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –ø–æ–¥–¥–µ–ª–∞–Ω ‚Üí 401 –æ—à–∏–±–∫–∞ –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –ª–æ–≥–∏–Ω.

**Q: –ú–æ–∂–Ω–æ –ª–∏ —Å–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É –≤–º–µ—Å—Ç–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞?**
A: –ú–æ–∂–Ω–æ, —ç—Ç–æ –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥:
```javascript
// –í–∞—Ä–∏–∞–Ω—Ç 1: –ó–∞—â–∏—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–∞ (–∫–∞–∫ —Å–µ–π—á–∞—Å)
<ProtectedRoute>
    <Order />
</ProtectedRoute>

// –í–∞—Ä–∏–∞–Ω—Ç 2: –°–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É
{token && <button onClick={() => navigate('/order')}>–ó–∞–∫–∞–∑–∞—Ç—å</button>}
```

**Q: –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —ç—Ç–æ —Å F5 (–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞)?**
A: –î–ê! –ü–æ—Ç–æ–º—É —á—Ç–æ —Ç–æ–∫–µ–Ω –≤ localStorage –∏ –Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ.

---

## –†–µ–∑—é–º–µ

| –ß—Ç–æ? | –ì–¥–µ? | –ó–∞—á–µ–º? |
|------|------|--------|
| ProtectedRoute | `Components/ProtectedRoute.jsx` | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∑–∞—â–∏—Ç—ã |
| getToken() | `api.js` | –î–æ—Å—Ç–∞–µ–º —Ç–æ–∫–µ–Ω –∏–∑ localStorage |
| Navigate | react-router-dom | –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –ª–æ–≥–∏–Ω |
| –û–±–æ—Ä–∞—á–∏–≤–∞–µ–º | `App.jsx` –≤ Routes | –ó–∞—â–∏—â–∞–µ–º –Ω—É–∂–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã |

**–ì–ª–∞–≤–Ω–æ–µ –ø–æ–º–Ω–∏—Ç—å:**
- ProtectedRoute –ø—Ä–æ–≤–µ—Ä—è–µ—Ç **–Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞**
- –°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç **–ø–æ–¥–ø–∏—Å—å —Ç–æ–∫–µ–Ω–∞** (–∫–æ–≥–¥–∞ –¥–µ–ª–∞–µ—à—å –∑–∞–ø—Ä–æ—Å)
- –í–º–µ—Å—Ç–µ —ç—Ç–æ –¥–∞–µ—Ç –ø–æ–ª–Ω—É—é –∑–∞—â–∏—Ç—É!
